# Pwn | Heap

## Информация

> В этот раз вам придётся собрать все ваши умения В КУЧУ.
> 
> Продемонстрируйте КУЧНОСТЬ ваших действий, чтобы не позволить корпорации ОКУЧИВАТЬ вас.
> 
> Не дайте Arbalests of Siberia ЗАСКУЧАТЬ.
> 
> `nc host 42202`
> 
> `flag in /tmp/flag.txt`


## Описание

Бинарник реализует типичный HEAP-интерфейс: создание, удаление, показ содержимого чанков.


## Решение

Из-за того, что используется уязвимая функция `strcpy`, в бинарнике происходит переполнение нулевым байтом чанка в HEAP.

1. Делаем overlapping chunks
2. Сливаем адрес libc
3. Спавним чанк на `__malloc_hook`
4. Перезаписываем его на one_gadget

[Пример решения](exploit.py)


## Флаг

`Cup{h34P_H3ap_He4p_HeAp_H34P_H3Ap}`
