# Crypto | Flag Checker

## Информация

> В этот раз ваше задание может быть не связано с корпорацией Arbalests of Siberia. 
> 
> Оно слишком секретное, поэтому мы вообще не скажем вам, с чем оно связано.
> 
> Вам нужно проникнуть в некое место, защищённое пропускной системой.
> 
> Проследите, как это делает их сотрудник, и повторите за ним.
> 
> `nc host 40121`


## Описание

[Сервис](service/server.py) предлагает ввести флаг и выводит в ответ сообщение о том, верный флаг или нет. Если флаг неверный, сервис сообщает, верная ли длина. 

В [дампе трафика](static/dump.pcap) видно подключение к сервису, но остальной трафик зашифрован с помощью `RSA`. Множители `p` и `q` для модуля `RSA` получаются с помощью [алгоритма Диффи-Хеллмана](https://ru.wikipedia.org/wiki/Протокол_Диффи_—_Хеллмана). 


## Решение

В этом таске нужно применить классическую атаку на RSA — [атаку Франклина-Рейтера](https://ru.wikipedia.org/wiki/Криптоанализ_RSA#Атака_Франклина-Рейтера). Все данные, которые нам нужны, есть в дампе трафика:

- модуль для RSA, можно восстановить через GCD
- `M` — флаг, который посылает клиент
- `k*M+t` — сообщение о том, что идёт проверка флага `M`, посылает сервер
- сообщение о том, что флаг `M` верен, посылает сервер

Переводим текст в числа, находим `k` и `t` и применяем атаку, чтобы вычислить `M`.

[Пример решения](exploit.sage)


## Флаг

`Cup{w41t_h0w_d1d_y0u_h4ck_my_pr0t0c0l???}`
