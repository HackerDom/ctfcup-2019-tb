# Reverse | Arbacoin wallet

## Информация

> По нашим оперативным данными, верхушка корпорации Arbalest of Siberia использует защищённые криптокошельки.
> 
> Силами групировок и жизнью несколько добропорядочных агентов.
> 
> Но оно запрашивает пароль на каждый кошёлек. Возможно у тебя получится разобраться с этим. 
> 
> Мы также нашли сервер, где генерируются эти кошельки. 
>
> Говорят, что в них есть некоторая приватная информация. Добудь её и сопротивление щедро отблагодарит тебя.
> 
> `nc <ip> <port>`


## Запуск

Отдать командам бинарник из deploy/static и ip-адрес сервера

```sh
cd deploy
# cange port in run.sh
./serve.sh 
```


## Описание

ELF 64bit, C++, no strip, no pack

Суть задания - разбор очень простого бинарного формата файла


## Решение

Анализируем исполняемый файл и понимает, что он парсит файл кошелька довольно простым образом. Первым байтом файла является размер зашифрованного логина, который лежит после этого байта. Данный байт является инициализирующим значение для генератора гаммы с которой XOR'ится логин. Такой же алгоритм используется для пароля. Достаточно вытащить пароль и логин из кошелька и открыть его с помощью предоставленного исполняемого файла. Флаг хранится в информации кошелька (поле Info).

[Пример эксплоита](solve/solve.py)


## Флаг

`Cup{901caa40579a07ee5912514eebaf5526742ad03261971b233fd1cb88eee915ae}}`
